<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ورود به داشبورد</title>
    <style>
        <style>
    body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(to bottom, #e1e8f0, #f4f6fa);
        margin: 0;
        padding: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
    }

    .login-container {
        background-color: #ffffff;
        padding: 20px 15px;
        border-radius: 12px;
        box-shadow: 0 6px 23px rgba(0, 0, 0, 0.1);
        width: 80%;
        max-width: 450px;
        text-align: center;
        direction: rtl;
    }

    .logo {
        width: 40px;
        margin-bottom: 4px;
    }

    h2 {
        margin-bottom: 25px;
        color: #1a237e;
        font-size: 22px;
        font-weight: 600;
    }

    .form-group {
        margin-bottom: 15px;
        text-align: Right;
        position: relative;
    }

    label {
        display: block;
        margin-bottom: 2px;
        font-size: 13px;
        color: #333;
    }

    input[type="text"] {
        width: 100%;
        padding: 10px 12px;
        border: 1px solid #ccc;
        border-radius: 6px;
        box-sizing: border-box;
        font-size: 14px;
        transition: border-color 0.3s ease;
    }

    input[type="text"]:focus {
        border-color: #1a73e8;
        outline: none;
    }

    button {
        background-color: #1a73e8;
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 6px;
        font-size: 16px;
        font-weight: 500;
        cursor: pointer;
        transition: background-color 0.3s ease;
        margin-top: 10px;
        width: 100%;
    }

    button:hover {
        background-color: #155ab6;
    }

    .error-message {
        color: #d32f2f;
        margin-top: 15px;
        font-size: 14px;
    }

    #nationalitySuggestions {
        position: absolute;
        top: calc(100% + 4px);
        left: 0;
        right: 0;
        background-color: #fff;
        border: 1px solid #ccc;
        border-top: none;
        border-radius: 0 0 6px 6px;
        box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
        z-index: 10;
        list-style: none;
        padding: 0;
        margin: 0;
        display: none;
        max-height: 150px;
        overflow-y: auto;
    }

    #nationalitySuggestions li {
        padding: 10px 12px;
        font-size: 14px;
        cursor: pointer;
        border-bottom: 1px solid #eee;
    }

    #nationalitySuggestions li:hover {
        background-color: #f1f1f1;
    }
</style>

</head>
<body>
    <div class="login-container">
        <img src="logo.png" alt="لوگو" class="logo">
        <h2>ورود به داشبورد کاربری</h2>
        <form id="loginForm">
            <div class="form-group">
                <label for="name">اسم:</label>
                <input type="text" id="name" name="name" required>
            </div>
            <div class="form-group">
                <label for="lastName">تخلص:</label>
                <input type="text" id="lastName" name="lastName" required>
            </div>
            <div class="form-group">
                <label for="nationality">ملیت:</label>
                <input type="text" id="nationality" name="nationality" autocomplete="off" required>
                <ul id="nationalitySuggestions"></ul>
            </div>
            <div class="form-group">
                <label for="passportNumber">نمبر پاسپورت:</label>
                <input type="text" id="passportNumber" name="passportNumber" required>
            </div>
            <div class="form-group">
                <label for="ceuNumber">نمبر CEU:</label>
                <input type="text" id="ceuNumber" name="ceuNumber" required>
            </div>
            <button type="submit">ورود</button>
            <div id="errorMessage" class="error-message" style="display: none;"></div>
        </form>
    </div>

    <script>
        const nationalityInput = document.getElementById('nationality');
        const nationalitySuggestions = document.getElementById('nationalitySuggestions');
        let countries = [];

        // Load countries from JSON
        fetch('countries.json')
            .then(response => response.json())
            .then(data => {
                countries = data.countries;
            });

        nationalityInput.addEventListener('input', function() {
            const inputText = this.value.toLowerCase();
            const filteredCountries = countries.filter(country =>
                country.toLowerCase().includes(inputText)
            );

            displaySuggestions(filteredCountries);
        });

        function displaySuggestions(suggestions) {
            nationalitySuggestions.innerHTML = '';
            if (suggestions.length > 0 && nationalityInput.value.trim() !== '') {
                suggestions.forEach(country => {
                    const li = document.createElement('li');
                    li.textContent = country;
                    li.addEventListener('click', function() {
                        nationalityInput.value = country;
                        nationalitySuggestions.style.display = 'none';
                    });
                    nationalitySuggestions.appendChild(li);
                });
                nationalitySuggestions.style.display = 'block';
            } else {
                nationalitySuggestions.style.display = 'none';
            }
        }

        // Hide suggestions when focus is lost from the input field
        nationalityInput.addEventListener('blur', function() {
            // Delay hiding to allow click on suggestion
            setTimeout(() => {
                nationalitySuggestions.style.display = 'none';
            }, 200);
        });

        document.getElementById('loginForm').addEventListener('submit', function(event) {
            event.preventDefault();
            const formData = new FormData(this);
            const name = formData.get('name');
            const lastName = formData.get('lastName');
            const nationality = formData.get('nationality');
            const passportNumber = formData.get('passportNumber');
            const ceuNumber = formData.get('ceuNumber');
            const errorMessageDiv = document.getElementById('errorMessage');

            fetch('data.json')
                .then(response => response.json())
                .then(users => {
                    const userFound = users.some(user =>
                        user.name === name &&
                        user.lastName === lastName &&
                        user.nationality === nationality &&
                        user.passportNumber === passportNumber &&
                        user.ceuNumber === ceuNumber
                    );

                    if (userFound) {
                        window.location.href = dashboard.html?name=${encodeURIComponent(name)}&lastName=${encodeURIComponent(lastName)};
                    } else {
                        errorMessageDiv.textContent = 'اطلاعات ورود نادرست است.';
                        errorMessageDiv.style.display = 'block';
                    }
                })
                .catch(error => {
                    console.error('Error loading user data:', error);
                    errorMessageDiv.textContent = 'خطا در بارگیری اطلاعات کاربران.';
                    errorMessageDiv.style.display = 'block';
                });
        });
    </script>
</body>
</html>
